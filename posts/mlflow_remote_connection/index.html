<!DOCTYPE html>
<html lang="en-uk">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.74.3" />

    
    
    

<title>How can you connect to MLFlow registry remotely? â€¢ Machine learning in real life</title>
<meta name="google-site-verification" content="TCP3Xybh5xzOfqotpAWEcZvWXDkTewIEh8oUbcnpT3U" />
<meta name="description" content="" />
<meta itemprop="description" content="MLFlow is helpful when you are looking for reproducibility and MLOps. This tutorial will lead you to connect to MLFlow model registry from outside." />
<meta property="og:description" content="MLFlow is helpful when you are looking for reproducibility and MLOps. This tutorial will lead you to connect to MLFlow model registry from outside." />
<meta name="twitter:description" content="MLFlow is helpful when you are looking for reproducibility and MLOps. This tutorial will lead you to connect to MLFlow model registry from outside." />
<meta name="keywords" content="nastasia saby, nastasia, saby, engineer, data, deep learning, shallow learning, learning, machine, tests, unit, people, analytics, book, career, concepts, data science, machine learning, pomodoro, issue, failure, data drift, model drift, drift, mlops, dataops, devops, sexism, unit tests, improve, mistakes">
<meta name="application-name" content="How can you connect to MLFlow registry remotely? | Machine learning in real life" />
<meta property="og:site_name" content="" />
<meta itemprop="name" content="How can you connect to MLFlow registry remotely? | Machine learning in real life" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://mlinreallife.github.io/Logo3.png"/>

<meta name="twitter:title" content="How can you connect to MLFlow registry remotely?"/>
<meta name="twitter:description" content="MLFlow is helpful when you are looking for reproducibility and MLOps. This tutorial will lead you to connect to MLFlow model registry from outside."/>
<meta name="twitter:site" content="@saby_nastasia"/>

<meta property="og:title" content="How can you connect to MLFlow registry remotely?" />
<meta property="og:description" content="MLFlow is helpful when you are looking for reproducibility and MLOps. This tutorial will lead you to connect to MLFlow model registry from outside." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mlinreallife.github.io/posts/mlflow_remote_connection/" />
<meta property="og:image" content="https://mlinreallife.github.io/Logo3.png"/>
<meta property="article:published_time" content="2021-01-25T09:01:10+02:00" />
<meta property="article:modified_time" content="2020-12-31T08:39:31+01:00" />

<base href="https://mlinreallife.github.io/posts/mlflow_remote_connection/">
<link rel="canonical" href="https://mlinreallife.github.io/posts/mlflow_remote_connection/" itemprop="url" />
<meta name="url" content="https://mlinreallife.github.io/posts/mlflow_remote_connection/" />
<meta name="twitter:url" content="https://mlinreallife.github.io/posts/mlflow_remote_connection/" />
<meta property="og:url" content="https://mlinreallife.github.io/posts/mlflow_remote_connection/" />
<meta property="og:locale" content="en">
<meta name="language" content="English">


<meta itemprop="image" content="https://mlinreallife.github.io" />
<meta property="og:image" content="https://mlinreallife.github.io" />

<meta property="og:updated_time" content=2020-12-31T08:39:31&#43;0100 />
Sitemap & RSS Feed Tags
<link rel="sitemap" type="application/xml" title="Sitemap" href="https://mlinreallife.github.iositemap.xml" />



    






<link rel="stylesheet" href="https://mlinreallife.github.io/scss/hyde-hyde.3081c4981fb69a2783dd36ecfdd0e6ba7a158d4cbfdd290ebce8f78ba0469fc6.css" integrity="sha256-MIHEmB&#43;2mieD3Tbs/dDmunoVjUy/3SkOvOj3i6BGn8Y=">


<link rel="stylesheet" href="https://mlinreallife.github.io/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" type="image/png" sizes="144x144" href="https://mlinreallife.github.io/favicon.ico">
    <link rel="shortcut icon" type="image/png" href="https://mlinreallife.github.io/favicon.ico">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <h1 class="site__title">
        <a href="https://mlinreallife.github.io">Machine learning in real life</a>
      </h1>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/f1e09bf0b41e5559ff4623401378a1f8?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <h3 class="site__description">
         Nastasia Saby 
      </h3>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Machine learning in real life</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="https://mlinreallife.github.io/posts/">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="https://mlinreallife.github.io/newsletter/">
						<span>Newsletter</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="https://mlinreallife.github.io/nastasia_saby/">
						<span>About Me Nastasia Saby</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/@saby_nastasia" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    


  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>How can you connect to MLFlow registry remotely?</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Jan 25, 2021
    
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 3 min read
</div>


  </header>
  
  
  <div class="post">
    <p>TL;DR:
MLFlow is a tool to do model versioning. You can track your metrics, your parameters, log your model, register it in a <em>None</em>, <em>Staging</em> or <em>Production</em> stage. You can retrieve your model and all the associated information using MLFlow.</p>
<p>It goes without saying that it&rsquo;s helpful when you are looking for reproducibility and MLOps. And who is not looking for reproducibility and MLOps?</p>
<p>But, I&rsquo;ve recently experienced difficulties connecting to MLFlow registry from outside. This is why I&rsquo;ve decided to write a small tutorial about that. This tutorial will blow your mind &hellip; or maybe will just help you a bit.</p>
<h2 id="caution">Caution</h2>
<p>This tutorial is for people that already know MLFlow model registry but don&rsquo;t know how to use it from outside.</p>
<h2 id="situation">Situation</h2>
<p>You have a mlflow registry in a location named A.</p>
<p>You are in a location named B and you want to retrieve a model from A.</p>
<h2 id="create-your-secrets">Create your secrets</h2>
<ol>
<li>On the Databricks CLI, create a secret scope in your B environment:</li>
</ol>
<pre><code>databricks secrets create-scope --scope &lt;scope&gt;
</code></pre><ol start="2">
<li>Pick a unique name for the target workspace, which we&rsquo;ll refer to. Then create three secrets:</li>
</ol>
<ul>
<li><code>databricks secrets put --scope &lt;scope&gt; --key &lt;prefix&gt;-host</code>. <em>Enter the hostname of the A model registry workspace</em>.</li>
<li><code>databricks secrets put --scope &lt;scope&gt; --key &lt;prefix&gt;-token</code>. <em>Enter the access token from the A model registry workspace</em>.</li>
<li><code>databricks secrets put --scope &lt;scope&gt; --key &lt;prefix&gt;-workspace-id</code>. <em>Enter the workspace ID for the A model registry workspace which can be found in the URL of any page in the workspace</em>.</li>
</ul>
<h2 id="indicate-where-you-want-to-be-connected">Indicate where you want to be connected</h2>
<p>Then, you have to create a registry_uri in B doing something like that:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">model_registry_secrets_scope <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;scope&gt;&#34;</span>
model_registry_secrets_prefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;prefix&gt;&#34;</span>

registry_uri <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#34;databricks://{model_registry_secrets_scope}:{model_registry_secrets_prefix}&#34;</span>
</code></pre></div><h2 id="retrieve-your-model">Retrieve your model</h2>
<p>Use this registry_uri with MLFlow doing something like that in B:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#f92672">import</span> mlflow

mlflow<span style="color:#f92672">.</span>set_tracking_uri(registry_uri)

model_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&lt;name-of-your-model&gt;&#34;</span>
stage <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;name-of-your-stage&gt;&#39;</span>

model <span style="color:#f92672">=</span> mlflow<span style="color:#f92672">.</span>xgboost<span style="color:#f92672">.</span>load_model(
    model_uri<span style="color:#f92672">=</span>f<span style="color:#e6db74">&#34;models:/{model_name}/{stage}&#34;</span>
)
</code></pre></div><p>Woohoo! You get your model! If you&rsquo;re like me, you&rsquo;re super excited! But sometimes, it&rsquo;s not enough ðŸ˜•.</p>
<h2 id="retrieve-information-about-your-models">Retrieve information about your models</h2>
<p>When you want to retrieve information about your models, you need to go through <em>MLFlowClient</em>.</p>
<p>Same here, you can use the <em>registry_uri</em> in B:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">customized_mlflow_client <span style="color:#f92672">=</span> mlflow<span style="color:#f92672">.</span>tracking<span style="color:#f92672">.</span>MlflowClient(tracking_uri<span style="color:#f92672">=</span>None, registry_uri<span style="color:#f92672">=</span>registry_uri)

customized_mlflow_client<span style="color:#f92672">.</span>list_registered_models()
</code></pre></div><p>Here you are! ðŸ˜„</p>
<p>Thank you for reading. I hope it would have helped you a bit. Feel free to contact me on <a href="https://twitter.com/saby_nastasia">Twitter</a> if you want to discuss that or if I can help.
Many people have helped me to understand this problem. Then, I would be delighted to do the same ðŸ˜„.</p>
<p>MLFlow is a tool I admire. It was designed by Databricks. This company also offers services to introduce you to this one. I&rsquo;m not working for Databricks. It&rsquo;s not an advertisement, just a piece of information I give to you. I was helped by Databricks myself.</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="https://mlinreallife.github.io/posts/press_review_6/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Issue 6: The past, present and, future of AI and ML</span>
    </a>
    
    
</div>


  

  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.11.2/js/all.js" integrity="sha384-b3ua1l97aVGAPEIe48b4TC60WUQbQaGi2jqAWM90y0OZXZeyaTCWtBTKtjW2GXG1" crossorigin="anonymous"></script>




    



    </body>
</html>
